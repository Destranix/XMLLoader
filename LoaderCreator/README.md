This is not yet refactored or documented. Use at your own risk.
